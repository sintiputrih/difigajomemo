<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="[add] So my next problem is that when i try adding a new dependence (npm install --save socket.io). The JSON file is also valid. I get this error: Failed to parse json So I've been trying to figure out why this error has been returning. All of the files (HTML,JSON,JS) are inside the same folder"><meta name=generator content="Hugo 0.98.0"><meta name=robots content="index,follow,noarchive"><title>node.js TypeError: path must be absolute or specify root to res.sendFile [failed to parse JSON] &#183;</title><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css><!--[if lte IE 8]><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css><![endif]--><!--[if gt IE 8]><!--><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css><!--<![endif]--><!--[if lte IE 8]><link rel=stylesheet href=https://assets.cdnweb.info/hugo/blackburn/css/side-menu-old-ie.css><![endif]--><!--[if gt IE 8]><!--><link rel=stylesheet href=https://assets.cdnweb.info/hugo/blackburn/css/side-menu.css><!--<![endif]--><link rel=stylesheet href=https://assets.cdnweb.info/hugo/blackburn/css/blackburn.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel=stylesheet type=text/css><script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css><script async src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js></script>
<script>hljs.initHighlightingOnLoad()</script><link rel="shortcut icon" href=./img/favicon.ico type=image/x-icon></head><body><div id=layout><a href=#menu id=menuLink class=menu-link><span></span></a><div id=menu><a class="pure-menu-heading brand" href=./index.html>MoxVlog</a><div class=pure-menu><ul class=pure-menu-list><li class=pure-menu-item><a class=pure-menu-link href=./index.html><i class="fa fa-home fa-fw"></i>Home</a></li><li class=pure-menu-item><a class=pure-menu-link href=./post/index.html><i class="fa fa-list fa-fw"></i>Posts</a></li><li class=pure-menu-item><a class=pure-menu-link href=./sitemap.xml><i class="fa fa-user fa-fw"></i>Sitemap</a></li><li class=pure-menu-item><a class=pure-menu-link href=./index.xml><i class="fa fa-phone fa-fw"></i>RSS</a></li></ul></div><div class="pure-menu social"><ul class=pure-menu-list></ul></div><div><div class=small-print><small>&copy; 2022. All rights reserved.</small></div><div class=small-print><small>Built with&nbsp;<a href=https://gohugo.io/ target=_blank>Hugo</a></small>
<small>Theme&nbsp;<a href=https://github.com/yoshiharuyamashita/blackburn target=_blank>Blackburn</a></small></div></div></div><div id=main><div class=header><h1>node.js TypeError: path must be absolute or specify root to res.sendFile [failed to parse JSON]</h1><h2>[add] So my next problem is that when i try adding a new dependence (npm install --save socket.io). The JSON file is also valid. I get this error: Failed to parse json So I've been trying to figure out why this error has been returning. All of the files (HTML,JSON,JS) are inside the same folder</h2></div><div class=content><div class=post-meta><div><i class="fa fa-calendar fa-fw"></i>
<time>27 Mar 2024, 00:00</time></div></div><img src=https://cdn.statically.io/img/cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png style=margin:auto;display:block;text-align:center;max-width:100%;height:auto><p>[add] So my next problem is that when i try adding a new dependence (npm install --save socket.io). The JSON file is also valid. I get this error: Failed to parse json</p><pre><code>npm ERR! Unexpected string npm ERR! File: /Users/John/package.json npm ERR! Failed to parse package.json data. npm ERR! package.json must be actual JSON, not just JavaScript. npm ERR! npm ERR! This is not a bug in npm. npm ERR! Tell the package author to fix their package.json file. JSON.parse </code></pre><p>So I've been trying to figure out why this error has been returning. All of the files (HTML,JSON,JS) are inside the same folder on my desktop. I'm using node.js and socket.io</p><p>This is my JS file:</p><pre><code>var app = require('express')(); var http = require('http').Server(app); app.get('/', function(req, res){ res.sendFile('index.html'); }); http.listen(3000,function(){ console.log('listening on : 3000'); }); </code></pre><p>This is what is getting returned:</p><pre><code>MacBook-Pro:~ John$ node /Users/John/Desktop/Chatapp/index.js listening on : 3000 TypeError: path must be absolute or specify root to res.sendFile at ServerResponse.sendFile (/Users/John/node_modules/express/lib/response.js:389:11) at /Users/John/Desktop/Chatapp/index.js:5:7 at Layer.handle [as handle_request] (/Users/John/node_modules/express/lib/router/layer.js:76:5) at next (/Users/John/node_modules/express/lib/router/route.js:100:13) at Route.dispatch (/Users/John/node_modules/express/lib/router/route.js:81:3) at Layer.handle [as handle_request] (/Users/John/node_modules/express/lib/router/layer.js:76:5) at /Users/John/node_modules/express/lib/router/index.js:234:24 at Function.proto.process_params (/Users/John/node_modules/express/lib/router/index.js:312:12) at /Users/John/node_modules/express/lib/router/index.js:228:12 at Function.match_layer (/Users/John/node_modules/express/lib/router/index.js:295:3) TypeError: path must be absolute or specify root to res.sendFile at ServerResponse.sendFile (/Users/John/node_modules/express/lib/response.js:389:11) at /Users/John/Desktop/Chatapp/index.js:5:7 at Layer.handle [as handle_request] (/Users/John/node_modules/express/lib/router/layer.js:76:5) at next (/Users/John/node_modules/express/lib/router/route.js:100:13) at Route.dispatch (/Users/John/node_modules/express/lib/router/route.js:81:3) at Layer.handle [as handle_request] (/Users/John/node_modules/express/lib/router/layer.js:76:5) at /Users/John/node_modules/express/lib/router/index.js:234:24 at Function.proto.process_params (/Users/John/node_modules/express/lib/router/index.js:312:12) at /Users/John/node_modules/express/lib/router/index.js:228:12 at Function.match_layer (/Users/John/node_modules/express/lib/router/index.js:295:3) </code></pre><span class=d-none itemprop=commentCount>1</span><h2 class=mb0 data-answercount=17>17 Answers</h2><p>The error is pretty clear, you need to specify an absolute (instead of relative) path and/or set <code>root</code> in the config object for <code>res.sendFile()</code>. Examples:</p><pre><code>// assuming index.html is in the same directory as this script res.sendFile(__dirname + '/index.html'); </code></pre><p>or specify a root (which is used as the base path for the first argument to <code>res.sendFile()</code>:</p><pre><code>res.sendFile('index.html', { root: __dirname }); </code></pre><p>Specifying the <code>root</code> path is more useful when you're passing a user-generated file path which could potentially contain malformed/malicious parts like <code>..</code> (e.g. <code>../../../../../../etc/passwd</code>). Setting the <code>root</code> path prevents such malicious paths from being used to access files outside of that base path.</p><span class=d-none itemprop=commentCount>5</span><p>in .mjs files we for now don't have __dirname</p><p>hence</p><pre><code>res.sendFile('index.html', { root: '.' }) </code></pre><span class=d-none itemprop=commentCount>3</span><p>Try adding root path.</p><pre><code>app.get('/', function(req, res) { res.sendFile('index.html', { root: __dirname }); }); </code></pre><span class=d-none itemprop=commentCount>0</span><p>I used the code below and tried to show the sitemap.xml file</p><pre><code>router.get('/sitemap.xml', function (req, res) { res.sendFile('sitemap.xml', { root: '.' }); }); </code></pre><span class=d-none itemprop=commentCount>1</span><p>If you trust the path, path.resolve is an option:</p><pre><code>var path = require('path'); // All other routes should redirect to the index.html app.route('/*') .get(function(req, res) { res.sendFile(path.resolve(app.get('appPath') + '/index.html')); }); </code></pre><span class=d-none itemprop=commentCount></span><p>The error is pretty straightforward. Most likely the reason is that your index.html file is not in the root directory.</p><p>Or if it is in the root directory then the relative referencing is not working.</p><p>So you need to tell the server exact location of your file. This could be done by using dirname method in NodeJs. Just replace your code with this one:</p><pre><code> app.get('/', function(req, res){ res.sendFile(__dirname + '/index.html'); }); </code></pre><p>Make sure that your add the slash "/" symbol before your homepage. Otherwise your path will become: rootDirectoryindex.html</p><p>Whereas you want it to be: rootDirectory/index.html</p><span class=d-none itemprop=commentCount></span><p>If you are working on Root Directory then you can use this approach</p><pre><code>res.sendFile(__dirname + '/FOLDER_IN_ROOT_DIRECTORY/index.html'); </code></pre><p>but if you are using Routes which is inside a folder lets say <code>/Routes/someRoute.js</code> then you will need to do something like this</p><pre><code>const path = require("path"); ... route.get("/some_route", (req, res) =&gt; { res.sendFile(path.resolve('FOLDER_IN_ROOT_DIRECTORY/index.html') }); </code></pre><span class=d-none itemprop=commentCount></span><p>In Typescript with relative path to the icon:</p><pre><code>import path from 'path'; route.get('/favicon.ico', (_req, res) =&gt; res.sendFile(path.join(__dirname, '../static/myicon.png'))); </code></pre><span class=d-none itemprop=commentCount></span><p>It will redirects to index.html on localhost:8080 call.</p><pre><code>app.get('/',function(req,res){ res.sendFile('index.html', { root: __dirname }); }); </code></pre><span class=d-none itemprop=commentCount></span><p>I solve this by using path variable. The sample code will look like below.</p><pre><code>var path = require("path"); app.get('/', (req, res) =&gt; { res.sendFile(path.join(__dirname + '/index.html')); }) </code></pre><span class=d-none itemprop=commentCount></span><p>this configuration in app.js worked fine for me :</p><pre><code> //production mode if (process.env.NODE_ENV === "production") { app.use(express.static(path.join(__dirname, "client/build"))); app.get("*", (req, res) =&gt; { res.sendFile(path.join((__dirname + "/client/build/index.html"))); }); } //build mode app.get("*", (req, res) =&gt; { res.sendFile(path.join(__dirname + "/client/public/index.html")); }); </code></pre><span class=d-none itemprop=commentCount></span><p>Unfortunately in ES6, to get access to absolute path <code>__dir_name</code> you will have to enter the following code everywhere:</p><pre><code>import { dirname } from 'path'; import { fileURLToPath } from 'url' const __filename = fileURLToPath(import.meta.url); const __dirname = dirname(__filename); </code></pre><p>Or create a <code>path.js</code> with the functions you want to use:</p><pre><code>import { join, dirname } from 'path'; import { fileURLToPath } from 'url' const __filename = fileURLToPath(import.meta.url); const __dirname = dirname(__filename); export { __dirname, join }; </code></pre><p>And import before using: <code>import { join, __dirname } from './path.js';</code></p><span class=d-none itemprop=commentCount></span><p>Something that happened to me is that when using res.sendFile, I got a console message similar to: "path must be absolute or specific root to res.sendFile" because the local variable <strong>__dirname</strong> returns a relative path, instead use <strong>procces.cwd()</strong> to locate my app root and pass the folder where my templates are hosted. Maybe it is not the best option but for the moment it works for me:</p><pre><code>import process from "process" import path from "path"; let templates = path.join(process.cwd(), "src\\public\\templates") app.get("/", function(req, res){ res.sendFile('403.html', {root: templates}); }); </code></pre><span class=d-none itemprop=commentCount></span><p>Just Do it it will solve your problem.</p><p><strong><code>res.sendFile('index.html', {root: '.'})</code></strong></p><p>Explanation:</p><p>=> This code will send the "index.html" file located in the root directory of the server as the response when the request will made.</p><p>=> The first argument is the file path relative to the root directory, in this case, "index.html". The second argument, { root: '.' }, specifies the root directory from which the file should be served.</p><span class=d-none itemprop=commentCount></span><p>This can be resolved in another way:</p><pre><code>app.get("/", function(req, res){ res.send(`${process.env.PWD}/index.html`) }); </code></pre><p><code>process.env.PWD</code> will prepend the working directory when the process was started.</p><span class=d-none itemprop=commentCount></span><p>I did this and now my app is working properly,</p><pre><code>res.sendFile('your drive://your_subfolders//file.html'); </code></pre><span class=d-none itemprop=commentCount>1</span><p>You might consider using double slashes on your directory e.g</p><pre class="snippet-code-js lang-js prettyprint-override"><code>app.get('/',(req,res)=&gt;{ res.sendFile('C:\\Users\\DOREEN\\Desktop\\Fitness Finder' + '/index.html') })</code></pre><span class=d-none itemprop=commentCount>0</span><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmirpJawrLvVnqmfpJ%2Bse6S7zGiorp2jqbawutJoaW9oZ26Dcn2Op6adnV2fwG7A2KmcnqqipL9uvMCtn2alpajBbq7EZpibq5%2BhwrWxjKipZqugmrCqsthmqainpGLBsHnRnqpmq5Wjsae1y55kn5mZobKl</p><h4><i class="fas fa-share-alt" aria-hidden=true></i>&nbsp;Share!</h4><ul class=share-buttons><li><a href="https://www.facebook.com/sharer/sharer.php?u=%2fnode-js-typeerror-path-must-be-absolute-or-specify-root-to-res-sendfile-failed.html" target=_blank title="Share on Facebook"><i class="fab fa-facebook" aria-hidden=true></i><span class=sr-only>Share on Facebook</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="https://twitter.com/intent/tweet?source=%2fnode-js-typeerror-path-must-be-absolute-or-specify-root-to-res-sendfile-failed.html" target=_blank title=Tweet><i class="fab fa-twitter" aria-hidden=true></i><span class=sr-only>Tweet</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="https://plus.google.com/share?url=%2fnode-js-typeerror-path-must-be-absolute-or-specify-root-to-res-sendfile-failed.html" target=_blank title="Share on Google+"><i class="fab fa-google-plus" aria-hidden=true></i><span class=sr-only>Share on Google+</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="http://www.tumblr.com/share?v=3&u=%2fnode-js-typeerror-path-must-be-absolute-or-specify-root-to-res-sendfile-failed.html" target=_blank title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden=true></i><span class=sr-only>Post to Tumblr</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="http://pinterest.com/pin/create/button/?url=%2fnode-js-typeerror-path-must-be-absolute-or-specify-root-to-res-sendfile-failed.html" target=_blank title="Pin it"><i class="fab fa-pinterest-p" aria-hidden=true></i><span class=sr-only>Pin it</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="http://www.reddit.com/submit?url=%2fnode-js-typeerror-path-must-be-absolute-or-specify-root-to-res-sendfile-failed.html" target=_blank title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden=true></i><span class=sr-only>Submit to Reddit</span></a></li></ul><style>ul.share-buttons{list-style:none;padding:0}ul.share-buttons li{display:inline}ul.share-buttons .sr-only{position:absolute;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);padding:0;border:0;height:1px;width:1px;overflow:hidden}</style><div class="prev-next-post pure-g"><div class=pure-u-1-24 style=text-align:left><a href=./sophie-reades-net-worth-biography-career-awards-fact-and-life-story.html><i class="fa fa-chevron-left"></i></a></div><div class=pure-u-10-24><nav class=prev><a href=./sophie-reades-net-worth-biography-career-awards-fact-and-life-story.html>Sophie Reades Net Worth, Biography, Career, Awards, Fact and Life Story</a></nav></div><div class=pure-u-2-24>&nbsp;</div><div class=pure-u-10-24><nav class=next><a href=./joely-fisher.html>Joely Fisher Celebrity Profile Hollywood Life</a></nav></div><div class=pure-u-1-24 style=text-align:right><a href=./joely-fisher.html><i class="fa fa-chevron-right"></i></a></div></div></div></div></div><script src=https://assets.cdnweb.info/hugo/blackburn/js/ui.js></script>
<script src=https://assets.cdnweb.info/hugo/blackburn/js/menus.js></script>
<script src=./js/math-code.js></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/banner.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>